package cc.slack.features.modules.impl.exploit.phases.impl;

import cc.slack.start.Slack;
import cc.slack.events.impl.player.MoveEvent;
import cc.slack.features.modules.impl.exploit.Phase;
import cc.slack.features.modules.impl.exploit.phases.IPhase;

public class ClipPhase implements IPhase {

    boolean insideBlock;

    @Override
    public void onEnable() {
        insideBlock = false;
    }

    @Override
    public void onMove(MoveEvent event) {
        double yaw = Math.toRadians(mc.thePlayer.rotationYaw);
        if (mc.thePlayer.isCollidedHorizontally) {
            insideBlock = true;
            mc.thePlayer.setPosition(
                    mc.thePlayer.posX + -Math.sin(yaw) * 0.005,
                    mc.thePlayer.posY,
                    mc.thePlayer.posZ + Math.cos(yaw) * 0.005);
        } else if (insideBlock) {
            mc.thePlayer.setPosition(
                    mc.thePlayer.posX + -Math.sin(yaw) * Slack.getInstance().getModuleManager().getInstance(Phase.class).offset.getValue(),
                    mc.thePlayer.posY,
                    mc.thePlayer.posZ + Math.cos(yaw) * Slack.getInstance().getModuleManager().getInstance(Phase.class).offset.getValue());
            insideBlock = false;
        }
    }

    @Override
    public String toString() {
        return "Clip";
    }
}
